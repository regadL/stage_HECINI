wss <- sapply(1:k.max,
function(k){kmeans(sc_data, k, nstart=50,iter.max = 100 )$tot.withinss})
wss
plot(1:k.max, wss,
type="b", pch = 19, frame = FALSE,
xlab="Number of clusters K",
ylab="Total within-clusters sum of squares")
for (i in 1: length(wss)-1){
print(wss[i]-wss[i+1])
}
###########################################
## lancer la kmeans avec  k = 3
"-------------------------------"
clusters_k = kmeans(sc_data, centers = 3, nstart=100,iter.max = 500)
#HCLUST
"-----"
dt_distDesc = dist(sc_data)
clah_Des = hclust(dt_distDesc, method = "ward.D2")
plot(clah_Des)
rect.hclust(clah_Des, 22)
clusters_Desc = cutree(clah_Des, k = 22)
poche_number <- factor(poche_number)
length(poche_number)
n_poche_numbers <- length(unique(poche_number))
cols_11 <- colorspace::rainbow_hcl(n_poche_numbers, c = 70, l  = 50)
col_poche_number <- cols_11[poche_number]
k234 <- cutree(dend, k = c(9,22))
k234
names(clusters_Desc) = gsub(".desc", replacement = "", names(clusters_Desc) )
dt_test = merge(k234,clusters_Desc, by = 0 , all = F)
dt_test
labels_colors(dend) <- col_poche_number[order.dendrogram(dend)]
dend <- color_branches(dend, k = 22)
par(mar = c(10,4,1,1))
plot(dend)
colored_bars(cbind(dt_test[,], col_poche_number[]), dend, rowLabels = c(paste0("k = ", c(9,22,3))))
colored_bars(cbind(dt_test[,], col_poche_number[]), dend)
dend
dend
plot(dend)
cbind(dt_test[,], col_poche_number[])
poche_number <- factor(poche_number)
poche_number
length
length(poche_number)
length(unique(poche_number))
n_poche_numbers <- length(unique(poche_number))
cols_11 <- colorspace::rainbow_hcl(n_poche_numbers, c = 70, l  = 50)
col_poche_number <- cols_11[poche_number]
cols_11 <- colorspace::rainbow_hcl(n_poche_numbers)
col_poche_number <- cols_11[poche_number]
# extra: showing the various clusters cuts
k234 <- cutree(dend, k = c(9,22))
names(clusters_Desc) = gsub(".desc", replacement = "", names(clusters_Desc) )
dt_test = merge(k234,clusters_Desc, by = 0 , all = F)
# color labels by car company:
labels_colors(dend) <- col_poche_number[order.dendrogram(dend)]
# color branches based on cutting the tree into 22 clusters:
dend <- color_branches(dend, k = 22)
### plots
par(mar = c(10,4,1,1))
plot(dend)
colored_bars(cbind(dt_test[,], col_poche_number[]), dend, rowLabels = c(paste0("k = ", c(9,22,3))))
col_poche_number
cbind(dt_test[,], col_poche_number[])
dend = as.dendrogram(hc)
plot(dend)
poche_number <- rep("Other", length(rownames(Mat)))
is_x <- grepl("pocket0", rownames(Mat))
poche_number[is_x] <- "0"
is_x <- grepl("pocket1", rownames(Mat))
poche_number[is_x] <- "1"
is_x <- grepl("pocket12", rownames(Mat))
poche_number[is_x] <- "12"
is_x <- grepl("pocket11", rownames(Mat))
poche_number[is_x] <- "11"
is_x <- grepl("pocket10", rownames(Mat))
poche_number[is_x] <- "10"
is_x <- grepl("pocket2", rownames(Mat))
poche_number[is_x] <- "2"
is_x <- grepl("pocket3", rownames(Mat))
poche_number[is_x] <- "3"
is_x <- grepl("pocket4", rownames(Mat))
poche_number[is_x] <- "4"
is_x <- grepl("pocket5", rownames(Mat))
poche_number[is_x] <- "5"
is_x <- grepl("pocket6", rownames(Mat))
poche_number[is_x] <- "6"
is_x <- grepl("pocket7", rownames(Mat))
poche_number[is_x] <- "7"
is_x <- grepl("pocket8", rownames(Mat))
poche_number[is_x] <- "8"
is_x <- grepl("pocket9", rownames(Mat))
poche_number[is_x] <- "9"
poche_number <- factor(poche_number)
length(poche_number)
n_poche_numbers <- length(unique(poche_number))
cols_11 <- colorspace::rainbow_hcl(n_poche_numbers)
col_poche_number <- cols_11[poche_number]
# extra: showing the various clusters cuts
k234 <- cutree(dend, k = c(9,22))
names(clusters_Desc) = gsub(".desc", replacement = "", names(clusters_Desc) )
dt_test = merge(k234,clusters_Desc, by = 0 , all = F)
# color labels by car company:
labels_colors(dend) <- col_poche_number[order.dendrogram(dend)]
# color branches based on cutting the tree into 22 clusters:
dend <- color_branches(dend, k = 22)
### plots
par(mar = c(10,4,1,1))
plot(dend)
colored_bars(cbind(dt_test[,], col_poche_number[]), dend, rowLabels = c(paste0("k = ", c(9,22,3))))
colored_bars(cbind(k24[,], col_poche_number[]), dend, rowLabels = c(paste0("k = ", c(9,22))))
colored_bars(cbind(k234[,], col_poche_number[]), dend, rowLabels = c(paste0("k = ", c(9,22))))
par(mar = c(10,4,1,1))
plot(dend)
colored_bars(cbind(k234[,], col_poche_number[]), dend, rowLabels = c(paste0("k = ", c(9,22))))
par(mar = c(20,4,1,1))
plot(dend)
colored_bars(cbind(k234[,], col_poche_number[]), dend, rowLabels = c(paste0("k = ", c(9,22))))
par(mar = c(18,4,1,1))
plot(dend)
colored_bars(cbind(k234[,], col_poche_number[]), dend, rowLabels = c(paste0("k = ", c(9,22))))
colored_bars(cbind(dt_test, col_poche_number[]), dend, rowLabels = c(paste0("k = ", c(9,22,1))))
cbind(dt_test, col_poche_number[])
colored_bars(cbind(dt_test, col_poche_number[]), dend, rowLabels = c(paste0("k = ", c(9,22,1))))
colored_bars(cbind(dt_test, col_poche_number), dend, rowLabels = c(paste0("k = ", c(9,22,1))))
cbind(dt_test, col_poche_number)
colored_bars(cbind(dt_test[1:83,], col_poche_number[1:83,]), dend, rowLabels = c(paste0("k = ", c(9,22,1))))
colored_bars(cbind(dt_test[1:83], col_poche_number[1:83]), dend, rowLabels = c(paste0("k = ", c(9,22,1))))
col_poche_number[1:83]
dt_test[1:83]
cbind(dt_test[1:83,], col_poche_number[1:83])
22
colored_bars(cbind(dt_test[1:83,], col_poche_number[1:83]), dend, rowLabels = c(paste0("k = ", c(9,22,1))))
colored_bars(cbind(dt_test,col_poche_number), dend, rowLabels = c(paste0("k = ", c(9,22,1))))
?colored_bars
cbind(k234[,], col_poche_number[])
cbind(dt_test,col_poche_number)
colored_bars(cbind(k234[,], col_poche_number[]), dend, rowLabels = c(paste0("k = ", c(9,22))))
par(mar = c(10,4,1,1))
plot(dend)
colored_bars(cbind(k234[,], col_poche_number[]), dend, rowLabels = c(paste0("k = ", c(9,22))))
par(mar = c(12,4,1,1))
plot(dend)
colored_bars(cbind(k234[,], col_poche_number[]), dend, rowLabels = c(paste0("k = ", c(9,22))))
par(mar = c(15,4,1,1))
plot(dend)
colored_bars(cbind(k234[,], col_poche_number[]), dend, rowLabels = c(paste0("k = ", c(9,22))))
par(mar = c(16,4,1,1))
plot(dend)
colored_bars(cbind(k234[,], col_poche_number[]), dend, rowLabels = c(paste0("k = ", c(9,22))))
par(mar = c(17,4,1,1))
plot(dend)
colored_bars(cbind(k234[,], col_poche_number[]), dend, rowLabels = c(paste0("k = ", c(9,22))))
par(mar = c(18,4,1,1))
plot(dend)
colored_bars(cbind(k234[,], col_poche_number[]), dend, rowLabels = c(paste0("k = ", c(9,22))))
rect.hclust(dend, k =22)
rect.hclust(dend, h = 1.3)
max(groupes=cutree(hc,h=1.3))
groupes=cutree(hc,h=1.3)
sort(groupes[])
nac = names(which(sort(groupes[]) == 9))
nac
data =  read.table("/home/hecini/Research/stage_HECINI/data/PR2/mat.mat")
which(is.na(data) == T) # pas de valeurs manquantes
dim(data)
#visualisation des données  :
boxplot(scale(data))
# nettoyage de données
# 1/ variables avec une variance proche de zero :
# 1ere méthode : j'ai pas toute les variables ..
var = apply(data, 2, sd)
which(var == 0)
# 2eme méthode : PARFAIT
library(caret)
vzero = nearZeroVar(data) # vecteur de variables avec une variance proche de zero
data_new = data[,-vzero] # un nouveau data frame sans ces variables
dim(data_new)
#matrice de corrélation
# créer la matrice de corrélation :
matcor = cor(data_new)
head(matcor)
# eliminer les variables avec une correlation importante :
vcorr = findCorrelation(matcor, cutoff = 0.75)
vcorr
data_new = data_new[,-vcorr]
dim(data_new)
# visualisation :
library(corrplot)
dt_cor = corrplot(matcor, method = "circle", type = 'upper')
### certaines variables n ont pas été éliminé du coup je repete le nettoyage
# eliminer les variables avec une correlation importante :
vcorr = findCorrelation(matcor, cutoff = 0.85)
vcorr
data_new = data_new[,-vcorr]
dim(data_new)
# créer la matrice de corrélation :
matcor = cor(data_new)
# visualisation :
dt_cor = corrplot(matcor, method = "circle", type = 'upper')
### classification :
nac %in% Mat
Mat
nac %in% rownames(Mat)
nac
which(nac %in% rownames(Mat))
which(nac %in% rownames(Mat), arr.ind = T)
data
data
rownames(data) = gsub(".desc", replacement = "", rownames(data) )
data
data[data[,1] == nac,]
which(data[data[,1] == nac,])
data[data[,1] == nac, 1]
data[data[,1] == nac, 2]
View(data)
View(data)
data["1HII_pocket0_atm.pdb",]
data[nac,]
apply(data[nac,], 2, sd)
aha = apply(data[nac,], 2, sd)
aha
summary(aha)
taille = max(groupes=cutree(hc,h=1.3))
for(v in 1:taille){
nac = names(which(sort(groupes[]) == v))
aha = apply(data[nac,], 2, sd)
var_data = data.frame(aha)
}
var_data
# étude de la variabilité !
dff = data.frame()
var_data = data.frame()
var_data = data.frame()
for(v in 1:taille){
nac = names(which(sort(groupes[]) == v))
aha = apply(data[nac,], 2, sd)
var_data$aha
}
var_data
var_data = data.frame()
for(v in 1:taille){
nac = names(which(sort(groupes[]) == v))
aha = apply(data[nac,], 2, sd)
var_data$aha
}
var_data
aha = apply(data[nac,], 2, sd)
aha
var_data$aha
colnames(var_data) = colnames(data)
?data.frame
var_data = data.frame(col.names = colnames(data))
var_data
View(var_data)
View(var_data)
var_data = data.frame(row.names = colnames(data))
var_data
View(var_data)
View(var_data)
var_data = merge(aha, var_data, by = 0 )
var_data
var_data = data.frame(row.names = colnames(data))
for(v in 1:taille){
nac = names(which(sort(groupes[]) == v))
aha = apply(data[nac,], 2, sd)
var_data = merge(aha, var_data, by = 0 )
}
var_data
var_data = data.frame(row.names = colnames(data))
for(v in 1:taille){
nac = names(which(sort(groupes[]) == v))
aha = apply(data[nac,], 2, sd)
var_data = merge(as.data.frame(aha), var_data, by = 0 )
}
var_data = data.frame(row.names = colnames(data))
for(v in 1:taille){
nac = names(which(sort(groupes[]) == v))
aha = apply(data[nac,], 2, sd)
var_data = merge(as.data.frame(aha), var_data, by = 0 )
}
warnings()
View(var_data)
View(var_data)
var_data = data.frame(row.names = colnames(data_new))
var_data
nac = names(which(sort(groupes[]) == v))
nac
aha = apply(data[nac,], 2, sd)
aha
var_data = list()
for(v in 1:taille){
nac = names(which(sort(groupes[]) == v))
var_data[[v]] = apply(data[nac,], 2, sd)
}
var_data
big_data = do.call(rbind, var_data)
big_data
View(big_data)
View(big_data)
big_data = as.data.frame(do.call(rbind, var_data))
View(big_data)
View(big_data)
var_data = list()
for(v in 1:taille){
nac = names(which(sort(groupes[]) == v))
var_data[[v]] = apply(data_new[nac,], 2, sd)
}
big_data = as.data.frame(do.call(rbind, var_data))
View(big_data)
View(big_data)
big_data
head(big_data)[,1:6]
var_data = list()
for(v in 1:taille){
nac = names(which(sort(groupes[]) == v))
writeLines(nac, sep = " ")
var_data[[v]] = apply(data_new[nac,], 2, sd)
}
big_data = as.data.frame(do.call(rbind, var_data))
head(big_data)[,1:6]
var_data = list()
for(v in 1:taille){
nac = names(which(sort(groupes[]) == v))
print(as.character(v))
writeLines(nac, sep = " ")
var_data[[v]] = apply(data_new[nac,], 2, sd)
}
hist(big_data[,1])
hist(big_data[,1])
big_data[,1]
boxplot(big_data[,1])
boxplot(big_data)
boxplot(scale(big_data))
boxplot(scale(big_data[1,]))
plot(big_data)
big_data
hist(big_data)
hist(big_data[,1:10])
hist(big_data[1,1:10])
hist(big_data[1,])
source('~/Research/stage_HECINI/script/scores_analysis.R', echo=TRUE)
big_data
hist(big_data)
hist(as.numeric(big_data))
hist(lapply(as.numeric(big_data),unlist))
lapply(as.numeric(big_data),unlist)
big_data = as.data.frame(do.call(rbind, var_data))
View(big_data)
View(big_data)
big_data[1,]
hist(big_data[1,])
hist(as.numeric(big_data[1,]))
taille
plot(c(1:24),big_data[,1])
par(mfrow = c(3,2))
for(b in 1:37){
plot(c(1:24),big_data[,b])
}
par(mfrow = c(3,2))
for(b in 1:37){
plot(c(1:24),big_data[,b])
}
par(mfrow = c(3,2))
for(b in 1:37){
plot(c(1:24),big_data[,b], xlab = colnames(big_data[,b]))
}
colnames(big_data[,b])
colnames(big_data)[1]
par(mfrow = c(3,2))
for(b in 1:37){
plot(c(1:24),big_data[,b], xlab = colnames(big_data)[b])
}
par(mfrow = c(3,2))
for(b in 1:37){
plot(c(1:24),big_data[,b], xlab = colnames(big_data)[b])
}
dend = as.dendrogram(hc)
plot(dend)
poche_number <- rep("Other", length(rownames(Mat)))
is_x <- grepl("pocket0", rownames(Mat))
poche_number[is_x] <- "0"
is_x <- grepl("pocket1", rownames(Mat))
poche_number[is_x] <- "1"
is_x <- grepl("pocket12", rownames(Mat))
poche_number[is_x] <- "12"
is_x <- grepl("pocket11", rownames(Mat))
poche_number[is_x] <- "11"
is_x <- grepl("pocket10", rownames(Mat))
poche_number[is_x] <- "10"
is_x <- grepl("pocket2", rownames(Mat))
poche_number[is_x] <- "2"
is_x <- grepl("pocket3", rownames(Mat))
poche_number[is_x] <- "3"
is_x <- grepl("pocket4", rownames(Mat))
poche_number[is_x] <- "4"
is_x <- grepl("pocket5", rownames(Mat))
poche_number[is_x] <- "5"
is_x <- grepl("pocket6", rownames(Mat))
poche_number[is_x] <- "6"
is_x <- grepl("pocket7", rownames(Mat))
poche_number[is_x] <- "7"
is_x <- grepl("pocket8", rownames(Mat))
poche_number[is_x] <- "8"
is_x <- grepl("pocket9", rownames(Mat))
poche_number[is_x] <- "9"
poche_number <- factor(poche_number)
length(poche_number)
n_poche_numbers <- length(unique(poche_number))
cols_11 <- colorspace::rainbow_hcl(n_poche_numbers)
col_poche_number <- cols_11[poche_number]
# extra: showing the various clusters cuts
k234 <- cutree(dend, k = c(9,22))
names(clusters_Desc) = gsub(".desc", replacement = "", names(clusters_Desc) )
dend = as.dendrogram(hc)
plot(dend)
poche_number <- rep("Other", length(rownames(Mat)))
is_x <- grepl("pocket0", rownames(Mat))
poche_number[is_x] <- "0"
is_x <- grepl("pocket1", rownames(Mat))
poche_number[is_x] <- "1"
is_x <- grepl("pocket12", rownames(Mat))
poche_number[is_x] <- "12"
is_x <- grepl("pocket11", rownames(Mat))
poche_number[is_x] <- "11"
is_x <- grepl("pocket10", rownames(Mat))
poche_number[is_x] <- "10"
is_x <- grepl("pocket2", rownames(Mat))
poche_number[is_x] <- "2"
is_x <- grepl("pocket3", rownames(Mat))
poche_number[is_x] <- "3"
is_x <- grepl("pocket4", rownames(Mat))
poche_number[is_x] <- "4"
is_x <- grepl("pocket5", rownames(Mat))
poche_number[is_x] <- "5"
is_x <- grepl("pocket6", rownames(Mat))
poche_number[is_x] <- "6"
is_x <- grepl("pocket7", rownames(Mat))
poche_number[is_x] <- "7"
is_x <- grepl("pocket8", rownames(Mat))
poche_number[is_x] <- "8"
is_x <- grepl("pocket9", rownames(Mat))
poche_number[is_x] <- "9"
poche_number <- factor(poche_number)
length(poche_number)
n_poche_numbers <- length(unique(poche_number))
cols_11 <- colorspace::rainbow_hcl(n_poche_numbers)
col_poche_number <- cols_11[poche_number]
# extra: showing the various clusters cuts
k234 <- cutree(dend, k = c(9,22))
names(clusters_Desc) = gsub(".desc", replacement = "", names(clusters_Desc) )
library(dendextend)
library(dendextend)
dend = as.dendrogram(hc)
plot(dend)
poche_number <- rep("Other", length(rownames(Mat)))
is_x <- grepl("pocket0", rownames(Mat))
poche_number[is_x] <- "0"
is_x <- grepl("pocket1", rownames(Mat))
poche_number[is_x] <- "1"
is_x <- grepl("pocket12", rownames(Mat))
poche_number[is_x] <- "12"
is_x <- grepl("pocket11", rownames(Mat))
poche_number[is_x] <- "11"
is_x <- grepl("pocket10", rownames(Mat))
poche_number[is_x] <- "10"
is_x <- grepl("pocket2", rownames(Mat))
poche_number[is_x] <- "2"
is_x <- grepl("pocket3", rownames(Mat))
poche_number[is_x] <- "3"
is_x <- grepl("pocket4", rownames(Mat))
poche_number[is_x] <- "4"
is_x <- grepl("pocket5", rownames(Mat))
poche_number[is_x] <- "5"
is_x <- grepl("pocket6", rownames(Mat))
poche_number[is_x] <- "6"
is_x <- grepl("pocket7", rownames(Mat))
poche_number[is_x] <- "7"
is_x <- grepl("pocket8", rownames(Mat))
poche_number[is_x] <- "8"
is_x <- grepl("pocket9", rownames(Mat))
poche_number[is_x] <- "9"
poche_number <- factor(poche_number)
length(poche_number)
n_poche_numbers <- length(unique(poche_number))
cols_11 <- colorspace::rainbow_hcl(n_poche_numbers)
col_poche_number <- cols_11[poche_number]
# extra: showing the various clusters cuts
k234 <- cutree(dend, k = c(9,22))
names(clusters_Desc) = gsub(".desc", replacement = "", names(clusters_Desc) )
dt_test = merge(k234,clusters_Desc, by = 0 , all = F)
# color labels by car company:
labels_colors(dend) <- col_poche_number[order.dendrogram(dend)]
# color branches based on cutting the tree into 22 clusters:
dend <- color_branches(dend, k = 22)
par(mar = c(18,4,1,1))
plot(dend)
colored_bars(cbind(k234[,], col_poche_number[]), dend, rowLabels = c(paste0("k = ", c(9,22))))
par(mar = c(20,4,1,1))
plot(dend)
colored_bars(cbind(k234[,], col_poche_number[]), dend, rowLabels = c(paste0("k = ", c(9,22))))
par(mar = c(25,4,1,1))
plot(dend)
colored_bars(cbind(k234[,], col_poche_number[]), dend, rowLabels = c(paste0("k = ", c(9,22))))
par(mar = c(20,4,1,1))
plot(dend)
colored_bars(cbind(k234[,], col_poche_number[]), dend, rowLabels = c(paste0("k = ", c(9,22))))
colored_bars( cbind(dt_test,col_poche_number) ,  dend)
cbind(dt_test,col_poche_number)
getwd(
)
